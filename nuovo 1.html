<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visualizzazione e Download dei File</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.2/animate.min.css">
    <style>
        /* (Existing styles) */

        /* Add styles for smaller screens */
        @media only screen and (max-width: 600px) {
            table {
                width: 100%;
            }
        }
    </style>
</head>

<body>

    <h1 class="animated fadeInDown">Ara Sbem</h1>

    <!-- Search bar -->
    <input type="text" id="searchInput" placeholder="Search files...">

    <!-- Loading spinner -->
    <div id="loadingSpinner" class="spinner-border text-light" role="status">
        <span class="sr-only">Loading...</span>
    </div>

    <table class="animated slideInUp">
        <thead>
            <tr>
                <th>File Type</th>
                <th>Nome del File</th>
                <th>Download</th>
            </tr>
        </thead>
        <tbody id="fileList"></tbody>
    </table>

    <script>
        const githubUrl = 'https://api.github.com/repos/arasbem/ara/contents/FILE?ref=main';
        const loadingSpinner = document.getElementById('loadingSpinner');
        const searchInput = document.getElementById('searchInput');

        async function getFiles() {
            try {
                loadingSpinner.style.display = 'block'; // Show loading spinner
                const response = await fetch(githubUrl);
                const data = await response.json();

                const fileList = document.getElementById('fileList');
                data.forEach(file => {
                    const row = fileList.insertRow();
                    const fileType = getFileType(file.name);

                    // Add file type icon in the first column
                    const fileTypeCell = row.insertCell(0);
                    fileTypeCell.innerHTML = `<img src="icons/${fileType}-icon.png" alt="${fileType} Icon">`;

                    // Add the file name in the second column
                    const fileNameCell = row.insertCell(1);
                    fileNameCell.textContent = file.name;

                    // Add the download button in the third column
                    const downloadCell = row.insertCell(2);
                    const downloadLink = document.createElement('a');
                    downloadLink.href = file.download_url;
                    downloadLink.textContent = 'Download';
                    downloadLink.setAttribute('download', '');
                    downloadCell.appendChild(downloadLink);
                });
            } catch (error) {
                console.error('Errore nel recupero dei file:', error);
            } finally {
                loadingSpinner.style.display = 'none'; // Hide loading spinner
            }
        }

        // Function to get file type based on file extension
        function getFileType(fileName) {
            const extension = fileName.split('.').pop().toLowerCase();
            // Add more file types as needed
            if (['pdf'].includes(extension)) {
                return 'pdf';
            } else if (['jpg', 'jpeg', 'png', 'gif'].includes(extension)) {
                return 'image';
            } else {
                return 'default';
            }
        }

        // Add an event listener for the search input
        searchInput.addEventListener('input', filterFiles);

        // Function to filter files based on user input
        function filterFiles() {
            const searchTerm = searchInput.value.toLowerCase();
            const fileRows = document.querySelectorAll('#fileList tr');

            fileRows.forEach(row => {
                const fileName = row.cells[1].textContent.toLowerCase();
                row.style.display = fileName.includes(searchTerm) ? '' : 'none';
            });
        }

        // Call the function to get the list of files when the page is fully loaded
        window.onload = getFiles;
    </script>

</body>

</html>
