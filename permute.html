<!DOCTYPE html>
<html lang="it">
<head>
    <!-- Il resto del codice del tuo head rimane invariato -->
</head>
<body>
    <div class="container">
        <div class="data-container" id="data-container">
            <div class="data-items" id="data-items">
                <!-- I dati delle colonne verranno inseriti qui -->
            </div>
            <div class="row-number" id="row-number">
                <!-- Numero della riga verrÃ  inserito qui -->
            </div>
        </div>
        <div class="row-navigation">
            <button id="prev-row">Precedente</button>
            <button id="next-row">Successivo</button>
        </div>
        <div class="search-container">
            <input type="number" id="row-search" placeholder="Cerca riga" min="1" />
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.1/xlsx.full.min.js"></script>
    <script>
        let excelData = [];
        let currentRowIndex = 0;

        document.addEventListener('DOMContentLoaded', loadExcel);
        document.getElementById('row-search').addEventListener('input', searchRow);

        function loadExcel() {
            fetch('permute.xlsx')
                .then(response => response.arrayBuffer())
                .then(data => {
                    const workbook = XLSX.read(data, {type: 'array'});
                    const firstSheetName = workbook.SheetNames[0];
                    const worksheet = workbook.Sheets[firstSheetName];
                    excelData = XLSX.utils.sheet_to_json(worksheet, {header: 1});
                    
                    // Ordina i dati basandoti sulla colonna "A"
                    excelData = excelData.slice(1).sort((a, b) => a[0] - b[0]); 
                    
                    displayRowByIndex(0);
                });
        }

        function displayRowByIndex(index) {
            if (index < 0 || index >= excelData.length) return;
            currentRowIndex = index;
            const row = excelData[index];
            const dataItems = document.getElementById('data-items');
            const rowNumber = document.getElementById('row-number');
            dataItems.innerHTML = '';
            rowNumber.textContent = `Riga ${row[0]}`; // Mostra il progressivo della colonna "A"

            // Ordina le colonne secondo l'ordine specificato: 3, 1, 2, 4
            const columnOrder = [2, 0, 1, 3];
            columnOrder.forEach(index => {
                const header = excelData[0][index]; 
                const cellData = row[index] !== undefined ? row[index] : '-';
                const dataItem = document.createElement('div');
                dataItem.classList.add('data-item');
                dataItem.classList.add(`col-${String.fromCharCode(98 + index)}`);
                dataItem.textContent = `${header}: ${cellData}`;
                dataItems.appendChild(dataItem);
            });

            window.scrollTo(0, 0);
        }

        function searchRow() {
            const searchValue = parseInt(document.getElementById('row-search').value);
            if (!isNaN(searchValue)) {
                const foundIndex = excelData.findIndex(row => row[0] === searchValue);
                if (foundIndex !== -1) {
                    displayRowByIndex(foundIndex);
                }
            }
        }

        document.getElementById('prev-row').addEventListener('click', () => navigateRow(-1));
        document.getElementById('next-row').addEventListener('click', () => navigateRow(1));

        function navigateRow(offset) {
            displayRowByIndex(currentRowIndex + offset);
        }
    </script>
</body>
</html>
